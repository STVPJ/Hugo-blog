<script>
  if (window.netlifyIdentity) {
    window.netlifyIdentity.on("init", user => {
      const url = new URL(window.location.href);
      const inviteToken = url.hash.match(/invite_token=([^&]+)/);

      if (inviteToken) {
        // If there's an invite token, open the Netlify Identity modal
        window.netlifyIdentity.open();
      } else if (!user) {
        window.netlifyIdentity.on("login", () => {
          document.location.href = "/admin/";
        });
      }
    });

    window.netlifyIdentity.init();
  }
</script>